<!DOCTYPE html>
<html lang="en">
<head>
  <!-- 2022-05-22 Sun 17:23 -->
  <meta charset="utf-8">
  <meta name="viewport" content=
  "width=device-width, initial-scale=1">
  <title>Eloquent JavaScript</title>
  <meta name="author" content="Toby Law">
  <meta name="generator" content="Org Mode">
  <link rel="stylesheet" href="res/tufte.min.css">
  <script async defer data-website-id=
  "6e6d5221-0e72-43ef-8e6e-27955832c259" src=
  "https://analytics.tzcl.me/umami.js"></script>
</head>
<body>
  <article id="content" class="content">
    <header>
      <h1 class="title">Eloquent JavaScript</h1>
      <p class="subtitle" role="doc-subtitle">Marijn Haverbeke</p>
    </header>
    <nav id="table-of-contents" role="doc-toc">
      <h2></h2>
      <div id="text-table-of-contents" role="doc-toc">
        <ul>
          <li>
            <a href="#org076b9f7">Review</a>
          </li>
          <li>
            <a href="#org8c0e161">Project 1: Path-finding robot</a>
          </li>
          <li>
            <a href="#org56ef9f0">Project 2: Egg programming
            language</a>
          </li>
          <li>
            <a href="#org7860efb">Project 3: Platformer game</a>
          </li>
          <li>
            <a href="#org75eee08"><span class=
            "todo TODO">TODO</span> Game of Life</a>
          </li>
          <li>
            <a href="#org16814c5"><span class=
            "todo TODO">TODO</span> Project 4: Pixel art editor</a>
          </li>
          <li>
            <a href="#org6e7a6f3"><span class=
            "todo TODO">TODO</span> Project 5: Skill-sharing
            website</a>
          </li>
        </ul>
      </div>
    </nav>
    <p><a href="index.html">← Back to blog</a></p>
    <section id="org076b9f7" class="nil">
      <h2 id="org076b9f7">Review</h2>
      <p><a href="https://eloquentjavascript.net/">Eloquent
      JavaScript</a> is a book that teaches you the fundamentals of
      programming through JavaScript. From a cursory glance online,
      it seemed to the be the most recommended, with other popular
      suggestions being <a href="https://javascript.info/">The
      Modern JavaScript Tutorial</a>, <a href=
      "https://www.amazon.com/JavaScript-Definitive-Most-Used-Programming-Language-dp-1491952024/dp/1491952024">
      JavaScript: The Definitive Guide</a> and the <a href=
      "https://github.com/getify/You-Dont-Know-JS">You Don’t Know
      JS Yet</a> book series.</p>
      <p>Overall, I really enjoyed the text and the exercises. The
      level of difficulty scales up pretty quickly so I wouldn’t
      recommend this book as a first introduction to programming
      but if you have learned another language it should be
      manageable. The projects were a lot of fun and satisfying to
      implement.</p>
      <p>JavaScript has an interesting history, given how it was
      rapidly hacked together by Brendan Eich and how the web has
      evolved since then. Some of the design decisions are
      questionable and very confusing as a beginner but actually
      make some sense once you understand them. Before reading
      Eloquent JavaScript, I was working my way through <a href=
      "https://mitpress.mit.edu/sites/default/files/sicp/index.html">
      SICP</a><label for="1" class=
      "margin-toggle sidenote-number"></label><input type=
      "checkbox" id="1" class="margin-toggle"><span class=
      "sidenote">One of the great classics of computer
      science</span> and you can really see the inspiration that
      JavaScript took from Scheme.</p>
      <p>Below are my solutions to the projects and the
      accompanying exercises from the text.</p>
    </section>
    <section id="org8c0e161" class="nil">
      <h2 id="org8c0e161">Project 1: Path-finding robot</h2>
      <p>The first project of the book is to build a mail-delivery
      robot that picks up and drops off parcels. Immediately, we
      are exposed to graphs and path-finding algorithms<label for=
      "2" class=
      "margin-toggle sidenote-number"></label><input type="checkbox"
      id="2" class="margin-toggle"><span class="sidenote">These are
      not the focus of the project but are cool to see</span>, and
      get to try solve an interesting problem.</p>
      <p><a href="./eloquentjs/robot/robot.html">Try out the robot
      here!</a></p>
      <p>I need to keep going at this, stuck on implementing
      controls. Need to do some thinking on how to organise this
      all.</p>
      <h3 id="org4b30327">Measuring a robot</h3>
      <h3 id="org86d1406">Robot efficiency</h3>
    </section>
    <section id="org56ef9f0" class="nil">
      <h2 id="org56ef9f0">Project 2: Egg programming language</h2>
      <p>In this project we build our own simple programming
      language called Egg:</p>
      <pre class="code"><code><span style=
      "color: #859900; font-weight: bold;">do</span>(define(x, <span style="color: #6c71c4; font-weight: bold;">10</span>),
   <span style=
"color: #859900; font-weight: bold;">if</span>(&gt;(x, <span style=
"color: #6c71c4; font-weight: bold;">5</span>),
      print(<span style="color: #2aa198;">"large"</span>),
      print(<span style="color: #2aa198;">"small"</span>)))

# Console: large
</code></pre>
      <p>Egg is a tiny, simple language with a simple, uniform
      syntax. Everything in Egg is an expression. An expression can
      be a value, an identifier, or an application. Applications
      are what is applied to a function or a special form like
      <code>if</code> or <code>while</code>.</p>
      <p>Expressions of type “value” represent literal strings or
      numbers. Their <code>value</code> property contains the
      string or number value that they represent. Expressions of
      type “identifier” are used for names (variables or bindings).
      Such objects have a <code>name</code> property that holds the
      identifier’s name as a string. Finally, “apply” expressions
      represent applications. They have an <code>operator</code>
      property that refers to the expression that is being applied,
      as well as an <code>args</code> property that holds an array
      of argument expressions.</p>
      <p>The <code>&gt;(x, 5)</code> part of the previous program
      would be represented like this:</p>
      <pre class="code"><code>{
  type: <span style="color: #2aa198;">"apply"</span>,
  operator: {type: <span style=
"color: #2aa198;">"identifier"</span>, name: <span style=
"color: #2aa198;">"&gt;"</span>},
  args: [
    {type: <span style=
"color: #2aa198;">"identifier"</span>, name: <span style=
"color: #2aa198;">"x"</span>},
    {type: <span style=
"color: #2aa198;">"value"</span>, value: <span style=
"color: #6c71c4; font-weight: bold;">5</span>}
  ]
}
</code></pre>
      <p>To let us do interesting things in our language, we
      include a few special forms and useful bindings in the global
      scope:</p>
      <ul class="org-ul">
        <li>Special forms: <code>if</code>, <code>while</code>,
        <code>do</code> to do multiple things in one expression,
        <code>define</code> to create bindings, and
        <code>fun</code> to create functions</li>
        <li>Global scope: <code>true</code>, <code>false</code>,
        <code>+, -, *, /</code>, <code>print</code> to print to the
        console</li>
      </ul>
      <p><a href="./eloquentjs/egg/egg.html">Try out the Egg
      interpreter!</a></p>
      <h3 id="orgc79095a">Arrays</h3>
      <p>We can implement arrays in Egg by adding the functions
      <code>array</code>, <code>length</code>, and
      <code>element</code> to the global scope. Respectively, they
      initialise an array, compute its length, and retrieve an
      element by index. Like with <code>if</code> and
      <code>while</code>, we cheat and use JavaScript’s arrays in
      our implementation.</p>
      <pre class=
      "code"><code>globalScope.array = (...values) =&gt; {
  <span style=
"color: #859900; font-weight: bold;">return</span> [...values];
};

globalScope.length = (array) =&gt; {
  <span style=
"color: #859900; font-weight: bold;">return</span> array.length;
};

globalScope.element = (array, n) =&gt; {
  <span style=
"color: #859900; font-weight: bold;">return</span> array[n];
};
</code></pre>
      <h3 id="orgb717884">Comments</h3>
      <p>Allowing comments in Egg is a matter of changing the
      parser so it skips the rest of the line when it encounters a
      <code>#</code>.</p>
      <pre class="code"><code><span style=
      "color: #859900; font-weight: bold;">function</span> <span style=
      "color: #b58900;">skipSpace</span>(<span style=
      "color: #268bd2;">string</span>) {
  <span style=
"color: #859900; font-weight: bold;">let</span> <span style=
"color: #268bd2;">skippable</span> = string.match(<span style=
"color: #2aa198;">/^(\s|#.*)*/</span>);
  <span style=
"color: #859900; font-weight: bold;">return</span> string.slice(skippable[<span style="color: #6c71c4; font-weight: bold;">0</span>].length);
}
</code></pre>
      <h3 id="orgf1fe884">Fixing scope</h3>
      <p>Assigning a new value to a binding with
      <code>define</code> can be counterintuitive because it may
      create a new binding in the local scope instead of updating
      the desired binding. We can get around this by adding the
      <code>set</code> function which will search for the binding
      in outer scopes.</p>
      <pre class=
      "code"><code>specialForms.set = (args, scope) =&gt; {
  <span style=
"color: #859900; font-weight: bold;">if</span> (args.length != <span style="color: #6c71c4; font-weight: bold;">2</span> || args[<span style="color: #6c71c4; font-weight: bold;">0</span>].type != <span style="color: #2aa198;">"identifier"</span>) {
    <span style=
"color: #859900; font-weight: bold;">throw</span> <span style=
"color: #859900; font-weight: bold;">new</span> <span style=
"color: #b58900; font-style: italic;">SyntaxError</span>(<span style="color: #2aa198;">"Incorrect use of set"</span>);
  }

  <span style=
"color: #859900; font-weight: bold;">let</span> <span style=
"color: #268bd2;">value</span> = evaluate(args[<span style=
"color: #6c71c4; font-weight: bold;">1</span>], scope);
  <span style=
"color: #859900; font-weight: bold;">let</span> <span style=
"color: #268bd2;">name</span> = args[<span style=
"color: #6c71c4; font-weight: bold;">0</span>].name;

  <span style=
"color: #859900; font-weight: bold;">for</span> (<span style=
"color: #859900; font-weight: bold;">let</span> <span style=
"color: #268bd2;">s</span> = scope; s; s = Object.getPrototypeOf(s)) {
    <span style=
"color: #859900; font-weight: bold;">if</span> (Object.<span style=
"color: #6c71c4; font-weight: bold;">prototype</span>.hasOwnProperty(s, name)) {
      s[name] = value;
      <span style=
"color: #859900; font-weight: bold;">return</span> value;
    }
  }

  <span style=
"color: #859900; font-weight: bold;">throw</span> <span style=
"color: #859900; font-weight: bold;">new</span> <span style=
"color: #b58900; font-style: italic;">ReferenceError</span>(<span style="color: #2aa198;">`Could not find ${name} in any scope.`</span>);
};
</code></pre>
    </section>
    <section id="org7860efb" class="nil">
      <h2 id="org7860efb">Project 3: Platformer game</h2>
      <p>This project uses the DOM as the rendering backend for a
      simple 2D platformer. Everything in the game is made of
      <code>div</code> elements with styling and positioning
      applied. You can actually get decent performance by adding
      and removing DOM elements, although working this way can feel
      a little clunky<label for="3" class=
      "margin-toggle sidenote-number"></label><input type=
      "checkbox" id="3" class="margin-toggle"><span class=
      "sidenote">A more idiomatic approach is to use the
      <code>&lt;canvas&gt;</code> element</span>.</p>
      <p><a href="./eloquentjs/platformer/platformer.html">Try out
      the platformer game here!</a></p>
      <h3 id="orgbf259d5">Game over</h3>
      <p>We can keep track of the player’s lives by adding some
      logic to the function that starts the game.</p>
      <pre class="code"><code><span style=
      "color: #859900; font-weight: bold;">async</span> <span style=
      "color: #859900; font-weight: bold;">function</span> runGame(<span style="color: #268bd2;">plans</span>, <span style="color: #268bd2;">Display</span>) {
  <span style=
"color: #859900; font-weight: bold;">let</span> <span style=
"color: #268bd2;">lives</span> = <span style=
"color: #6c71c4; font-weight: bold;">3</span>;
  <span style=
"color: #859900; font-weight: bold;">for</span> (<span style=
"color: #859900; font-weight: bold;">let</span> <span style=
"color: #268bd2;">level</span> = <span style=
"color: #6c71c4; font-weight: bold;">0</span>; level &lt; plans.length; ) {
    console.log(<span style=
"color: #2aa198;">`Lives: ${lives}`</span>);
    <span style=
"color: #859900; font-weight: bold;">let</span> <span style=
"color: #268bd2;">status</span> = <span style=
"color: #859900; font-weight: bold;">await</span> runLevel(<span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900; font-style: italic;">Level</span>(plans[level]), Display);
    <span style=
"color: #859900; font-weight: bold;">if</span> (status == <span style="color: #2aa198;">"lost"</span>) {
      lives--;
      <span style=
"color: #859900; font-weight: bold;">if</span> (lives == <span style="color: #6c71c4; font-weight: bold;">0</span>) {
        console.log(<span style=
"color: #2aa198;">"You lost, restarting the game..."</span>);
        level = <span style=
"color: #6c71c4; font-weight: bold;">0</span>;
        lives = <span style=
"color: #6c71c4; font-weight: bold;">3</span>;
      }
    }
    <span style=
"color: #859900; font-weight: bold;">if</span> (status == <span style="color: #2aa198;">"won"</span>) level++;
  }
  console.log(<span style="color: #2aa198;">"You've won!"</span>);
}
</code></pre>
      <h3 id="org3f40239">Pausing the game</h3>
      <p>Adding a way to pause/unpause the game is not immediately
      obvious since adding another key listener in the section
      where we listen to user input won’t work. The solution is to
      add the key listener for pausing higher up, putting that
      logic into the <code>runLevel</code> function.</p>
      <pre class="code"><code><span style=
      "color: #859900; font-weight: bold;">function</span> <span style=
      "color: #b58900;">runLevel</span>(<span style=
      "color: #268bd2;">level</span>, <span style=
      "color: #268bd2;">Display</span>) {
  <span style=
"color: #859900; font-weight: bold;">let</span> <span style=
"color: #268bd2;">display</span> = <span style=
"color: #859900; font-weight: bold;">new</span> <span style=
"color: #b58900; font-style: italic;">Display</span>(document.body, level);
  <span style=
"color: #859900; font-weight: bold;">let</span> <span style=
"color: #268bd2;">state</span> = State.start(level);
  <span style=
"color: #859900; font-weight: bold;">let</span> <span style=
"color: #268bd2;">ending</span> = <span style=
"color: #6c71c4; font-weight: bold;">1</span>;
  <span style=
"color: #859900; font-weight: bold;">let</span> <span style=
"color: #268bd2;">running</span> = <span style=
"color: #2aa198;">"yes"</span>;

  <span style=
"color: #859900; font-weight: bold;">return</span> <span style=
"color: #859900; font-weight: bold;">new</span> <span style=
"color: #b58900; font-style: italic;">Promise</span>((resolve) =&gt; {
    <span style=
"color: #859900; font-weight: bold;">function</span> <span style=
"color: #b58900;">escHandler</span>(<span style=
"color: #268bd2;">event</span>) {
      <span style=
"color: #859900; font-weight: bold;">if</span> (event.key != <span style="color: #2aa198;">"Escape"</span>) <span style="color: #859900; font-weight: bold;">return</span>;
      event.preventDefault();
      <span style=
"color: #859900; font-weight: bold;">if</span> (running == <span style="color: #2aa198;">"no"</span>) {
        console.log(<span style=
"color: #2aa198;">"Unpausing game"</span>);
        running = <span style="color: #2aa198;">"yes"</span>;
        runAnimation(frame);
      } <span style=
"color: #859900; font-weight: bold;">else</span> <span style=
"color: #859900; font-weight: bold;">if</span> (running == <span style="color: #2aa198;">"yes"</span>) {
        console.log(<span style=
"color: #2aa198;">"Pausing game"</span>);
        running = <span style="color: #2aa198;">"pausing"</span>;
      } <span style=
"color: #859900; font-weight: bold;">else</span> {
        running = <span style="color: #2aa198;">"yes"</span>;
      }
    }

    window.addEventListener(<span style=
"color: #2aa198;">"keyup"</span>, escHandler);

    <span style=
"color: #859900; font-weight: bold;">let</span> <span style=
"color: #268bd2;">keys</span> = trackKeys([<span style=
"color: #2aa198;">"ArrowLeft"</span>, <span style=
"color: #2aa198;">"ArrowRight"</span>, <span style=
"color: #2aa198;">"ArrowUp"</span>, <span style=
"color: #2aa198;">"a"</span>, <span style=
"color: #2aa198;">"d"</span>, <span style=
"color: #2aa198;">"w"</span>]);

    <span style=
"color: #859900; font-weight: bold;">function</span> <span style=
"color: #b58900;">frame</span>(<span style=
"color: #268bd2;">time</span>) {
      <span style=
"color: #859900; font-weight: bold;">if</span> (running == <span style="color: #2aa198;">"pausing"</span>) {
        console.log(<span style=
"color: #2aa198;">"Game paused"</span>);
        running = <span style="color: #2aa198;">"no"</span>;
        <span style=
"color: #859900; font-weight: bold;">return</span> <span style=
"color: #6c71c4; font-weight: bold;">false</span>;
      }

      state = state.update(time, keys);
      display.syncState(state);
      <span style=
"color: #859900; font-weight: bold;">if</span> (state.status == <span style="color: #2aa198;">"playing"</span>) {
        <span style=
"color: #859900; font-weight: bold;">return</span> <span style=
"color: #6c71c4; font-weight: bold;">true</span>;
      } <span style=
"color: #859900; font-weight: bold;">else</span> <span style=
"color: #859900; font-weight: bold;">if</span> (ending &gt; <span style="color: #6c71c4; font-weight: bold;">0</span>) {
        ending -= time;
        <span style=
"color: #859900; font-weight: bold;">return</span> <span style=
"color: #6c71c4; font-weight: bold;">true</span>;
      } <span style=
"color: #859900; font-weight: bold;">else</span> {
        display.clear();
        window.removeEventListener(<span style=
"color: #2aa198;">"keyup"</span>, escHandler);
        keys.unregister();
        resolve(state.status);
        <span style=
"color: #859900; font-weight: bold;">return</span> <span style=
"color: #6c71c4; font-weight: bold;">false</span>;
      }
    }

    runAnimation(frame);
  });
}
</code></pre>
      <h3 id="org913a585"><span class="todo TODO">TODO</span> A
      monster</h3>
      <p>zzz</p>
    </section>
    <section id="org75eee08" class="nil">
      <h2 id="org75eee08"><span class="todo TODO">TODO</span> Game
      of Life</h2>
      <p>Using HTML forms, it’s possible to write a basic version
      of the Game of Life. Each generation, a checkbox transitions
      according to the following rules:</p>
      <ol class="org-ol">
        <li>Underpopulation: any checked checkbox with less than
        two checked neighbours becomes unchecked</li>
        <li>Survival: any checked checkbox with two or three
        neighbours stays checked in the next generation</li>
        <li>Overpopulation: any checked checkbox with more than
        three checked neighbours becomes unchecked</li>
        <li>Reproduction: any unchecked checkbox with exactly three
        neighbours becomes checked</li>
      </ol>
      <p>Technically, the Game of Life is meant to be played on an
      infinite grid. There are a few ways to address this, such as
      wrapping cells around to the other side of the grid in case
      they go off screen. However, I didn’t bother with this – try
      to imagine there is a sea of dead cells around the grid.</p>
      <p><a href="./eloquentjs/game-of-life/game-of-life.html">Try
      out the Game of Life!</a></p>
    </section>
    <section id="org16814c5" class="nil">
      <h2 id="org16814c5"><span class="todo TODO">TODO</span>
      Project 4: Pixel art editor</h2>
      <p>As discussed in the platformer project, another way to
      render graphics on the web is using
      <code>&lt;canvas&gt;</code> elements.</p>
      <p><a href="./eloquentjs/pixel-art/pixel-art.html">Try out
      the pixel art editor!</a></p>
    </section>
    <section id="org6e7a6f3" class="nil">
      <h2 id="org6e7a6f3"><span class="todo TODO">TODO</span>
      Project 5: Skill-sharing website</h2>
      <p>Need to host this somewhere… need Node to be running to
      keep store the talks.</p>
    </section><!-- Footnotes --><!-- 
<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1" role="doc-backlink">1</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">One of the great classics of computer science</p></div></div>

<div class="footdef"><sup><a id="fn.2" class="footnum" href="#fnr.2" role="doc-backlink">2</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">These are not the focus of the project but are cool to see</p></div></div>

<div class="footdef"><sup><a id="fn.3" class="footnum" href="#fnr.3" role="doc-backlink">3</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">A more idiomatic approach is to use the <code>&lt;canvas&gt;</code>  element</p></div></div>

 -->
  </article>
</body>
</html>
